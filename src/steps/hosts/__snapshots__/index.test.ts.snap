// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`#buildAccountHostRelationships should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Account",
      ],
      "_key": "datadog_account:local-integration",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "name": "Local Integration",
          },
        },
      ],
      "_type": "datadog_account",
      "createdOn": undefined,
      "displayName": "Local Integration",
      "name": "Local Integration",
    },
    Object {
      "_class": Array [
        "Host",
      ],
      "_key": "datadog_host:11654684",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "aliases": Array [
              "spoulton-MBP.local",
            ],
            "apps": Array [
              "agent",
              "ntp",
            ],
            "host_name": "spoulton-MBP.local",
            "id": 11654684,
            "is_muted": false,
            "last_reported_time": 1675893200,
            "meta": Object {
              "agent_checks": Array [
                Array [
                  "io",
                  "io",
                  "io",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "cpu",
                  "cpu",
                  "cpu",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "ntp",
                  "ntp",
                  "ntp:3c427a42a70bbf8",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "network",
                  "network",
                  "network:4b0649b7e11f0772",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "load",
                  "load",
                  "load",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "disk",
                  "disk",
                  "disk:67cc0574430a16ba",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "uptime",
                  "uptime",
                  "uptime",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "memory",
                  "memory",
                  "memory",
                  "OK",
                  "",
                  "",
                ],
              ],
              "agent_flavor": "agent",
              "agent_version": "7.42.1",
              "cpuCores": 8,
              "fbsdV": Array [
                null,
                null,
                null,
              ],
              "gohai": "{\\"cpu\\":{\\"cpu_cores\\":\\"8\\",\\"cpu_logical_processors\\":\\"16\\",\\"family\\":\\"6\\",\\"mhz\\":\\"2300\\",\\"model\\":\\"158\\",\\"model_name\\":\\"Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz\\",\\"stepping\\":\\"13\\",\\"vendor_id\\":\\"GenuineIntel\\"},\\"filesystem\\":[{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/\\",\\"name\\":\\"/dev/disk1s1s1\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Preboot\\",\\"name\\":\\"/dev/disk1s3\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/VM\\",\\"name\\":\\"/dev/disk1s5\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Update\\",\\"name\\":\\"/dev/disk1s6\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Data\\",\\"name\\":\\"/dev/disk1s2\\"}],\\"memory\\":{\\"swap_total\\":\\"11264.00M\\",\\"total\\":\\"17179869184\\"},\\"network\\":{\\"interfaces\\":[{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::aede:48ff:fe00:1122\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"ac:de:48:00:11:22\\",\\"name\\":\\"en7\\"},{\\"ipv4\\":[\\"192.168.0.101\\"],\\"ipv4-network\\":\\"192.168.0.0/24\\",\\"ipv6\\":[\\"fe80::1087:6c6e:ae2d:6e64\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"5c:52:30:9d:2e:7e\\",\\"name\\":\\"en0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::fc6c:a2ff:fecd:ea99\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"fe:6c:a2:cd:ea:99\\",\\"name\\":\\"awdl0\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en2\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en1\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en3\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en4\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"bridge0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::fc6c:a2ff:fecd:ea99\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"fe:6c:a2:cd:ea:99\\",\\"name\\":\\"llw0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::c803:8de1:77c5:66c7\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::5dce:f773:b48c:e1ff\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun1\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::ce81:b1c:bd2c:69e\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun2\\"},{\\"ipv4\\":[\\"192.168.0.114\\"],\\"ipv4-network\\":\\"192.168.0.0/24\\",\\"ipv6\\":[\\"fe80::14af:eaeb:9b56:a318\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"64:4b:f0:20:81:96\\",\\"name\\":\\"en5\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en8\\"}],\\"ipaddress\\":\\"192.168.0.101\\",\\"ipaddressv6\\":\\"fe80::aede:48ff:fe00:1122\\",\\"macaddress\\":\\"5c:52:30:9d:2e:7e\\"},\\"platform\\":{\\"GOOARCH\\":\\"amd64\\",\\"GOOS\\":\\"darwin\\",\\"goV\\":\\"1.18.9\\",\\"hostname\\":\\"spoulton-MBP.local\\",\\"kernel_name\\":\\"Darwin\\",\\"kernel_release\\":\\"22.2.0\\",\\"kernel_version\\":\\"Darwin Kernel Version 22.2.0: Fri Nov 11 02:08:47 PST 2022; root:xnu-8792.61.2~4/RELEASE_X86_64\\",\\"machine\\":\\"x86_64\\",\\"os\\":\\"Darwin\\",\\"processor\\":\\"i386\\"}}",
              "host_id": 11654684,
              "install_method": Object {
                "installer_version": "install_script_mac-1.1.0",
                "tool": "install_script_mac",
                "tool_version": "install_script_mac",
              },
              "logs_agent": Object {
                "auto_multi_line_detection_enabled": false,
                "transport": "",
              },
              "macV": Array [
                "13.1",
                Array [
                  "",
                  "",
                  "",
                ],
                "amd64",
              ],
              "machine": "amd64",
              "network": null,
              "nixV": Array [
                null,
                null,
                null,
              ],
              "platform": "darwin",
              "processor": "Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz",
              "pythonV": "3.8.16",
              "socket-fqdn": "localhost",
              "socket-hostname": "spoulton-MBP.local",
              "timezones": Array [
                "MST",
              ],
              "winV": Array [
                null,
                null,
                null,
              ],
            },
            "metrics": Object {
              "cpu": 12.230392,
              "iowait": 0,
              "load": 0.43045816,
            },
            "mute_timeout": null,
            "name": "spoulton-MBP.local",
            "sources": Array [
              "agent",
            ],
            "tags_by_source": Object {
              "Datadog": Array [
                "host:spoulton-MBP.local",
              ],
            },
            "up": true,
          },
        },
      ],
      "_type": "datadog_host",
      "agentVersion": "7.42.1",
      "aliases": Array [
        "spoulton-MBP.local",
      ],
      "apps": Array [
        "agent",
        "ntp",
      ],
      "awsName": undefined,
      "createdOn": undefined,
      "displayName": "spoulton-MBP.local",
      "hostCpuCores": 8,
      "hostname": "spoulton-MBP.local",
      "id": "11654684",
      "isMuted": false,
      "machine": "amd64",
      "name": "spoulton-MBP.local",
      "osName": "darwin",
      "osVersion": "13.1 amd64",
      "platform": "darwin",
      "processor": "Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz",
      "pythonVersion": "3.8.16",
      "reportedOn": 1675893200,
      "socketFqdn": "localhost",
      "socketHostname": "spoulton-MBP.local",
      "sources": Array [
        "agent",
      ],
      "state": "running",
    },
  ],
  "collectedRelationships": Array [
    Object {
      "_class": "HAS",
      "_fromEntityKey": "datadog_account:local-integration",
      "_key": "datadog_account:local-integration|has|datadog_host:11654684",
      "_toEntityKey": "datadog_host:11654684",
      "_type": "datadog_account_has_host",
      "displayName": "HAS",
    },
  ],
  "encounteredTypes": Array [
    "datadog_account",
    "datadog_host",
    "datadog_account_has_host",
  ],
  "numCollectedEntities": 2,
  "numCollectedRelationships": 1,
}
`;

exports[`#fetchHosts should collect data 1`] = `
Object {
  "collectedEntities": Array [
    Object {
      "_class": Array [
        "Host",
      ],
      "_key": "datadog_host:11654684",
      "_rawData": Array [
        Object {
          "name": "default",
          "rawData": Object {
            "aliases": Array [
              "spoulton-MBP.local",
            ],
            "apps": Array [
              "agent",
              "ntp",
            ],
            "host_name": "spoulton-MBP.local",
            "id": 11654684,
            "is_muted": false,
            "last_reported_time": 1675893200,
            "meta": Object {
              "agent_checks": Array [
                Array [
                  "io",
                  "io",
                  "io",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "cpu",
                  "cpu",
                  "cpu",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "ntp",
                  "ntp",
                  "ntp:3c427a42a70bbf8",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "network",
                  "network",
                  "network:4b0649b7e11f0772",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "load",
                  "load",
                  "load",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "disk",
                  "disk",
                  "disk:67cc0574430a16ba",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "uptime",
                  "uptime",
                  "uptime",
                  "OK",
                  "",
                  "",
                ],
                Array [
                  "memory",
                  "memory",
                  "memory",
                  "OK",
                  "",
                  "",
                ],
              ],
              "agent_flavor": "agent",
              "agent_version": "7.42.1",
              "cpuCores": 8,
              "fbsdV": Array [
                null,
                null,
                null,
              ],
              "gohai": "{\\"cpu\\":{\\"cpu_cores\\":\\"8\\",\\"cpu_logical_processors\\":\\"16\\",\\"family\\":\\"6\\",\\"mhz\\":\\"2300\\",\\"model\\":\\"158\\",\\"model_name\\":\\"Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz\\",\\"stepping\\":\\"13\\",\\"vendor_id\\":\\"GenuineIntel\\"},\\"filesystem\\":[{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/\\",\\"name\\":\\"/dev/disk1s1s1\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Preboot\\",\\"name\\":\\"/dev/disk1s3\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/VM\\",\\"name\\":\\"/dev/disk1s5\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Update\\",\\"name\\":\\"/dev/disk1s6\\"},{\\"kb_size\\":\\"976797816\\",\\"mounted_on\\":\\"/System/Volumes/Data\\",\\"name\\":\\"/dev/disk1s2\\"}],\\"memory\\":{\\"swap_total\\":\\"11264.00M\\",\\"total\\":\\"17179869184\\"},\\"network\\":{\\"interfaces\\":[{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::aede:48ff:fe00:1122\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"ac:de:48:00:11:22\\",\\"name\\":\\"en7\\"},{\\"ipv4\\":[\\"192.168.0.101\\"],\\"ipv4-network\\":\\"192.168.0.0/24\\",\\"ipv6\\":[\\"fe80::1087:6c6e:ae2d:6e64\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"5c:52:30:9d:2e:7e\\",\\"name\\":\\"en0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::fc6c:a2ff:fecd:ea99\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"fe:6c:a2:cd:ea:99\\",\\"name\\":\\"awdl0\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en2\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en1\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en3\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en4\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"bridge0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::fc6c:a2ff:fecd:ea99\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"fe:6c:a2:cd:ea:99\\",\\"name\\":\\"llw0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::c803:8de1:77c5:66c7\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun0\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::5dce:f773:b48c:e1ff\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun1\\"},{\\"ipv4\\":[],\\"ipv6\\":[\\"fe80::ce81:b1c:bd2c:69e\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"name\\":\\"utun2\\"},{\\"ipv4\\":[\\"192.168.0.114\\"],\\"ipv4-network\\":\\"192.168.0.0/24\\",\\"ipv6\\":[\\"fe80::14af:eaeb:9b56:a318\\"],\\"ipv6-network\\":\\"fe80::/64\\",\\"macaddress\\":\\"64:4b:f0:20:81:96\\",\\"name\\":\\"en5\\"},{\\"ipv4\\":[],\\"ipv6\\":[],\\"name\\":\\"en8\\"}],\\"ipaddress\\":\\"192.168.0.101\\",\\"ipaddressv6\\":\\"fe80::aede:48ff:fe00:1122\\",\\"macaddress\\":\\"5c:52:30:9d:2e:7e\\"},\\"platform\\":{\\"GOOARCH\\":\\"amd64\\",\\"GOOS\\":\\"darwin\\",\\"goV\\":\\"1.18.9\\",\\"hostname\\":\\"spoulton-MBP.local\\",\\"kernel_name\\":\\"Darwin\\",\\"kernel_release\\":\\"22.2.0\\",\\"kernel_version\\":\\"Darwin Kernel Version 22.2.0: Fri Nov 11 02:08:47 PST 2022; root:xnu-8792.61.2~4/RELEASE_X86_64\\",\\"machine\\":\\"x86_64\\",\\"os\\":\\"Darwin\\",\\"processor\\":\\"i386\\"}}",
              "host_id": 11654684,
              "install_method": Object {
                "installer_version": "install_script_mac-1.1.0",
                "tool": "install_script_mac",
                "tool_version": "install_script_mac",
              },
              "logs_agent": Object {
                "auto_multi_line_detection_enabled": false,
                "transport": "",
              },
              "macV": Array [
                "13.1",
                Array [
                  "",
                  "",
                  "",
                ],
                "amd64",
              ],
              "machine": "amd64",
              "network": null,
              "nixV": Array [
                null,
                null,
                null,
              ],
              "platform": "darwin",
              "processor": "Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz",
              "pythonV": "3.8.16",
              "socket-fqdn": "localhost",
              "socket-hostname": "spoulton-MBP.local",
              "timezones": Array [
                "MST",
              ],
              "winV": Array [
                null,
                null,
                null,
              ],
            },
            "metrics": Object {
              "cpu": 12.230392,
              "iowait": 0,
              "load": 0.43045816,
            },
            "mute_timeout": null,
            "name": "spoulton-MBP.local",
            "sources": Array [
              "agent",
            ],
            "tags_by_source": Object {
              "Datadog": Array [
                "host:spoulton-MBP.local",
              ],
            },
            "up": true,
          },
        },
      ],
      "_type": "datadog_host",
      "agentVersion": "7.42.1",
      "aliases": Array [
        "spoulton-MBP.local",
      ],
      "apps": Array [
        "agent",
        "ntp",
      ],
      "awsName": undefined,
      "createdOn": undefined,
      "displayName": "spoulton-MBP.local",
      "hostCpuCores": 8,
      "hostname": "spoulton-MBP.local",
      "id": "11654684",
      "isMuted": false,
      "machine": "amd64",
      "name": "spoulton-MBP.local",
      "osName": "darwin",
      "osVersion": "13.1 amd64",
      "platform": "darwin",
      "processor": "Intel(R) Core(TM) i9-9880H CPU @ 2.30GHz",
      "pythonVersion": "3.8.16",
      "reportedOn": 1675893200,
      "socketFqdn": "localhost",
      "socketHostname": "spoulton-MBP.local",
      "sources": Array [
        "agent",
      ],
      "state": "running",
    },
  ],
  "collectedRelationships": Array [],
  "encounteredTypes": Array [
    "datadog_host",
  ],
  "numCollectedEntities": 1,
  "numCollectedRelationships": 0,
}
`;
